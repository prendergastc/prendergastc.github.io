<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <link href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen" rel="stylesheet" type="text/css"/>
        <link href="./theme/css/custom.css" media="screen" rel="stylesheet" type="text/css"/>

        <link href="//fonts.googleapis.com" rel="dns-prefetch"/>
        <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
        <link href="https://files.stork-search.net/basic.css" rel="stylesheet"/>
        <link href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.css" rel="stylesheet"/>
        <link href="./theme/css/colorbox.css" rel="stylesheet"/>

        <meta content="Christopher Prendergast" name="author">

        <meta content="article" property="og:type">
        <meta content="summary" name="twitter:card"/>

<meta content="ArcGIS, ArcPy, Cartography, Python, ArcPy, " name="keywords">

<meta content="Voting Precincts, Santa Cruz County " property="og:title">
<meta content="./santa_cruz_precincts.html" property="og:url"/>
<meta content="Consolidate regular precincts into voting precincts. A layer with 720 regular precincts was provided together with a cross-reference table listing the 138 voting precincts that need to be created each with a corresponding list of their constituent regular precincts. Using Python and the arcpy api, this data was wrangled into a format where it can easily be joined to the regular precincts layer and the regular precinct features were dissolved to create 297 new voting precincts." property="og:description"/>
<meta content="portfolio" property="og:site_name"/>
<meta content="Christopher Prendergast" property="og:article:author"/>
<meta content="2024-05-31T00:00:00-07:00" property="og:article:published_time"/>
<meta content="2025-06-07T00:00:00-07:00" property="og:article:modified_time"/>
<meta content="Voting Precincts, Santa Cruz County " name="twitter:title"/>
<meta content="Consolidate regular precincts into voting precincts. A layer with 720 regular precincts was provided together with a cross-reference table listing the 138 voting precincts that need to be created each with a corresponding list of their constituent regular precincts. Using Python and the arcpy api, this data was wrangled into a format where it can easily be joined to the regular precincts layer and the regular precinct features were dissolved to create 297 new voting precincts." name="twitter:description"/>

        <title>Voting Precincts, Santa Cruz County  Â· portfolio
</title>



    </meta></meta></meta></meta></head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class="site-name">portfolio</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li>
                                    <a href=".">Home</a>
                                </li>
                                <li><a href="./pages/search.html">Search</a></li>
                                <li><a href="./categories.html">Categories</a></li>
                                <li><a href="./tags.html">Tags</a></li>
                                <li><a href="./archives.html">Archives</a></li>
                                <li><form action="./search.html" class="navbar-search" onsubmit="return validateForm(this.elements['q'].value);"> <input class="search-query" id="tipue_search_input" name="q" placeholder="Search" type="text"/></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope="">
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./santa_cruz_precincts.html">
                Voting Precincts, Santa Cruz County
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <main><p><img alt="Thumb" class="image-process-thumb" src="images/santa_cruz_precincts/png/derivatives/thumb/voting_precincts_noborder.png"/></p>
<p>Each election the Santa Cruz County Elections Department must consolidate regular precincts into a smaller number of voting precincts. For each election every person who registers to vote is assigned a regular precinct within the county based on the address they enter on their voter registration form. </p>
<p>Each election has several different ballot types based on the different jurisdictions that are up for an election. In order to reduce the number of different ballot types, if two or more adjacent regular precincts share all the same items on the ballot, then they are consolidated into a single voting precinct. These voting precincts are then used for tabulation and reporting. </p>
<p>A layer with 720 regular precincts was provided together with a cross-reference table listing the 138 voting precincts that need to be created each with a corresponding list of their constituent regular precincts. Using Python and the arcpy api, this data was wrangled into a format where it can easily be joined to the regular precincts layer and the regular precinct features were dissolved to create 297 new voting precincts.</p>
<h1 id="regular-precincts">Regular Precincts</h1>
<p>Map of the original 720 regular precincts.</p>
<p><a class="mybox" href="images/santa_cruz_precincts/png/regular_precincts_noborder.png"><img alt="Regular Precincts" class="image-process-large-photo" sizes="(min-width: 1200px) 800px, (min-width: 992px) 650px, (min-width: 768px) 718px, 100vw" src="images/santa_cruz_precincts/png/derivatives/large-photo/800w/regular_precincts_noborder.png" srcset="images/santa_cruz_precincts/png/derivatives/large-photo/600w/regular_precincts_noborder.png 600w, images/santa_cruz_precincts/png/derivatives/large-photo/800w/regular_precincts_noborder.png 800w, images/santa_cruz_precincts/png/derivatives/large-photo/1600w/regular_precincts_noborder.png 1600w"/></a></p>
<p><a href="./images/santa_cruz_precincts/pdf/regular_precincts.pdf">PDF file</a></p>
<h1 id="voting-precincts">Voting Precincts</h1>
<p>Consolidated voting precincts created by the procedure shown in ArcGIS Pro.</p>
<p><a class="mybox" href="images/santa_cruz_precincts/png/arcgispro_voting_precincts.png"><img alt="Voting Precincts" class="image-process-large-photo" sizes="(min-width: 1200px) 800px, (min-width: 992px) 650px, (min-width: 768px) 718px, 100vw" src="images/santa_cruz_precincts/png/derivatives/large-photo/800w/arcgispro_voting_precincts.png" srcset="images/santa_cruz_precincts/png/derivatives/large-photo/600w/arcgispro_voting_precincts.png 600w, images/santa_cruz_precincts/png/derivatives/large-photo/800w/arcgispro_voting_precincts.png 800w, images/santa_cruz_precincts/png/derivatives/large-photo/1600w/arcgispro_voting_precincts.png 1600w"/></a></p>
<p>Map of the 297 new consolidated voting precincts generated by the procedure.</p>
<p><a class="mybox" href="images/santa_cruz_precincts/png/voting_precincts_noborder.png"><img alt="Voting Precincts" class="image-process-large-photo" sizes="(min-width: 1200px) 800px, (min-width: 992px) 650px, (min-width: 768px) 718px, 100vw" src="images/santa_cruz_precincts/png/derivatives/large-photo/800w/voting_precincts_noborder.png" srcset="images/santa_cruz_precincts/png/derivatives/large-photo/600w/voting_precincts_noborder.png 600w, images/santa_cruz_precincts/png/derivatives/large-photo/800w/voting_precincts_noborder.png 800w, images/santa_cruz_precincts/png/derivatives/large-photo/1600w/voting_precincts_noborder.png 1600w"/></a></p>
<p><a href="./images/santa_cruz_precincts/pdf/voting_precincts.pdf">PDF file</a></p>
<h1 id="python-code">Python Code</h1>
<div class="highlight"><pre><span></span><code><span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># santa_cruz_precincts.py</span>
<span class="c1"># Christopher Prendergast</span>
<span class="c1"># 2024/05/15</span>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">global</span> <span class="n">g_proj_dir</span>
<span class="k">global</span> <span class="n">g_in_gdb</span>
<span class="k">global</span> <span class="n">g_temp_gdb</span>
<span class="k">global</span> <span class="n">g_out_gdb</span>


<span class="k">def</span> <span class="nf">full_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">basename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Convert basename to a full path given the root directory or</span>
<span class="sd">    geo-database path.</span>

<span class="sd">    :param str root_dir:    The root directory or file geo-database</span>
<span class="sd">                            path.</span>
<span class="sd">    :param str basename:    The basename of a geo-database or feature</span>
<span class="sd">                            class.</span>
<span class="sd">    :return str:            The root and basename joined as a path.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="n">basename</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">setup_env</span><span class="p">(</span><span class="n">proj_dir_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">in_gdb_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp_gdb_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
              <span class="n">out_gdb_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Set up the geo-database environment. Assign values to global</span>
<span class="sd">    variables g_in_gdb and g_out_gdb.</span>

<span class="sd">    :param str proj_dir_str:    The project directory.</span>
<span class="sd">    :param str in_gdb_str:      The basename of the input geo-database</span>
<span class="sd">                                within the project directory.</span>
<span class="sd">    :param str temp_gdb_str:    The full path of the temporary</span>
<span class="sd">                                geo-database.</span>
<span class="sd">    :param str out_gdb_str:     The basename of the output geo-database</span>
<span class="sd">                                within the project directory.</span>
<span class="sd">    :return NoneType:           None</span>
<span class="sd">    """</span>
    <span class="c1">#</span>
    <span class="c1"># Allow overwriting outputs.</span>
    <span class="c1"># Note: overwriting doesn't work if the layer is open in ArcGIS Pro</span>
    <span class="c1"># due to lock. Closing ArgGIS Pro releases the lock and the outputs</span>
    <span class="c1"># can be overwritten. See:</span>
    <span class="c1"># https://community.esri.com/t5/python-questions/arcpy-env-overwriteoutput-true-fails/m-p/411113#M32410</span>
    <span class="c1">#</span>
    <span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">overwriteOutput</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1">#</span>
    <span class="c1"># Check the project directory exists.</span>
    <span class="c1">#</span>
    <span class="k">global</span> <span class="n">g_proj_dir</span>
    <span class="n">g_proj_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">proj_dir_str</span><span class="p">))</span>
    <span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="n">g_proj_dir</span><span class="p">)</span><span class="o">.</span><span class="n">is_dir</span><span class="p">(),</span> \
        <span class="sa">f</span><span class="s2">"Can't find the project directory </span><span class="si">{</span><span class="n">g_proj_dir</span><span class="si">}</span><span class="s2">"</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...project directory:"</span><span class="p">,</span> <span class="n">g_proj_dir</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Assign global variables for the input and output geo-databases.</span>
    <span class="c1">#</span>
    <span class="k">global</span> <span class="n">g_in_gdb</span>
    <span class="n">g_in_gdb</span> <span class="o">=</span> <span class="n">full_path</span><span class="p">(</span><span class="n">proj_dir_str</span><span class="p">,</span> <span class="n">in_gdb_str</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">g_temp_gdb</span>
    <span class="n">g_temp_gdb</span> <span class="o">=</span> <span class="n">temp_gdb_str</span>
    <span class="k">global</span> <span class="n">g_out_gdb</span>
    <span class="n">g_out_gdb</span> <span class="o">=</span> <span class="n">full_path</span><span class="p">(</span><span class="n">proj_dir_str</span><span class="p">,</span> <span class="n">out_gdb_str</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Check the input and output geo-databases exist.</span>
    <span class="c1">#</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">g_in_gdb</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input geo-database: </span><span class="si">{</span><span class="n">g_in_gdb</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">g_temp_gdb</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find temporary geo-database: </span><span class="si">{</span><span class="n">g_temp_gdb</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">g_out_gdb</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find output geo-database: </span><span class="si">{</span><span class="n">g_out_gdb</span><span class="si">}</span><span class="s2">"</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...input geo-database:"</span><span class="p">,</span> <span class="n">g_in_gdb</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...temporary geo-database:"</span><span class="p">,</span> <span class="n">g_temp_gdb</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...output geo_database:"</span><span class="p">,</span> <span class="n">g_out_gdb</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">load_shapefile</span><span class="p">(</span><span class="n">shape_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_gdb</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Load a shapefile into feature class with the same name in the</span>
<span class="sd">    specified geodatabase.</span>

<span class="sd">    :param str shape_file:  The file path to the shapefile.</span>
<span class="sd">    :param str out_gdb:     The path to the geo-database.</span>
<span class="sd">    :return str:            The geo-database path to the feature class</span>
<span class="sd">                            created.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_shapefile, shape_file"</span><span class="p">,</span> <span class="n">shape_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_shapefile, out_gdb:"</span><span class="p">,</span> <span class="n">out_gdb</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">shape_file</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input shape_file: </span><span class="si">{</span><span class="n">shape_file</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">out_gdb</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input out_gdb: </span><span class="si">{</span><span class="n">out_gdb</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">arcpy</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">FeatureClassToGeodatabase</span><span class="p">(</span>
                <span class="n">Input_Features</span><span class="o">=</span><span class="p">[</span><span class="n">shape_file</span><span class="p">],</span>
                <span class="n">Output_Geodatabase</span><span class="o">=</span><span class="n">out_gdb</span>
            <span class="p">))</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_shapefile, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">201</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getMessages</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># Unpack first element of result object as return value.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># This tool ony returns the path to the gdb not the feature class.</span>
    <span class="c1"># So, construct path to feature class here.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">full_path</span><span class="p">(</span><span class="n">ret_val</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">shape_file</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_shapefile,"</span><span class="p">,</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span>
          <span class="s2">"precincts loaded from shapefile."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_shapefile, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">load_table</span><span class="p">(</span><span class="n">dbf_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_gdb</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Load a dbf file into a table with the same name in the specified</span>
<span class="sd">    geo-database.</span>

<span class="sd">    :param str dbf_file:    The file path to the dbf file.</span>
<span class="sd">    :param str out_gdb:     The path to the geo-database.</span>
<span class="sd">    :return str:            The geo-database path to the table created.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_table, dbf_file"</span><span class="p">,</span> <span class="n">dbf_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_table, out_gdb:"</span><span class="p">,</span> <span class="n">out_gdb</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">dbf_file</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input dbf_file: </span><span class="si">{</span><span class="n">dbf_file</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">out_gdb</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find input out_gdb: </span><span class="si">{</span><span class="n">out_gdb</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Result</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">TableToGeodatabase</span><span class="p">(</span>
            <span class="n">Input_Table</span><span class="o">=</span><span class="p">[</span><span class="n">dbf_file</span><span class="p">],</span>
            <span class="n">Output_Geodatabase</span><span class="o">=</span><span class="n">out_gdb</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_table, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">202</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getMessages</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># Unpack first element of result object as return value.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># This tool ony returns the path to the gdb not the feature class.</span>
    <span class="c1"># So, construct path to feature class here.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">full_path</span><span class="p">(</span><span class="n">ret_val</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">dbf_file</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_table,"</span><span class="p">,</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span>
          <span class="s2">"cross_reference records loaded from dbf file."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...load_table, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Create a new empty table in the specified geo-database.</span>

<span class="sd">    :param str out_path:    The path to the geo-database</span>
<span class="sd">    :param str out_name:    The name of the table to create.</span>
<span class="sd">    :return str:            The geo-database path to the table created.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...create_table, out_path"</span><span class="p">,</span> <span class="n">out_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...create_table, out_name:"</span><span class="p">,</span> <span class="n">out_name</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">out_path</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input out_path: </span><span class="si">{</span><span class="n">out_path</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Result</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">CreateTable</span><span class="p">(</span>
            <span class="n">out_path</span><span class="o">=</span><span class="n">out_path</span><span class="p">,</span>
            <span class="n">out_name</span><span class="o">=</span><span class="n">out_name</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...create_table, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">203</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getMessages</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># Unpack first element of result object as return value.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...create_table, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">add_fields</span><span class="p">(</span><span class="n">in_table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">field_description</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Add fields to a table in the geo-database.</span>

<span class="sd">    :param str in_table:            The geo-database path to the table.</span>
<span class="sd">    :param str field_description:   Specification of fields to add.</span>
<span class="sd">    :return str:                    The geo-database path to the table.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...add_fields, in_table"</span><span class="p">,</span> <span class="n">in_table</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...add_fields, field_description:"</span><span class="p">,</span> <span class="n">field_description</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">in_table</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input in_table: </span><span class="si">{</span><span class="n">in_table</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Result</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">AddFields</span><span class="p">(</span>
            <span class="n">in_table</span><span class="o">=</span><span class="n">in_table</span><span class="p">,</span>
            <span class="n">field_description</span><span class="o">=</span><span class="n">field_description</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...add_fields, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">204</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getMessages</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># Unpack first element of result object as return value.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...add_fields, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">join_by_field</span><span class="p">(</span><span class="n">in_data</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">in_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">join_table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                  <span class="n">join_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                  <span class="n">index_join_fields</span><span class="o">=</span><span class="s2">"NEW_INDEXES"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Join two feature classes/tables based on a common key and transfer</span>
<span class="sd">    the specified fields to one of the tables.</span>

<span class="sd">    :param str in_data:         The geo-database path to the 1st table.</span>
<span class="sd">    :param str in_field:        The join field in the 1st table.</span>
<span class="sd">    :param str join_table:      The geo-database path to the 2nd table.</span>
<span class="sd">    :param str str join_field:  The join field in the 2nd table.</span>
<span class="sd">    :param list fields:         The list of fields to transfer.</span>
<span class="sd">    :param str index_join_fields:   Whether to create new indexes.</span>
<span class="sd">    :return str:                The geo-database path to the resulting</span>
<span class="sd">                                table.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field, in_data"</span><span class="p">,</span> <span class="n">in_data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field, in_field:"</span><span class="p">,</span> <span class="n">in_field</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field, join_table:"</span><span class="p">,</span> <span class="n">join_table</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field, fields:"</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field, index_join_fields:"</span><span class="p">,</span> <span class="n">index_join_fields</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">in_data</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find input in_data: </span><span class="si">{</span><span class="n">in_data</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">join_table</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input in_table: </span><span class="si">{</span><span class="n">join_table</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Result</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">JoinField</span><span class="p">(</span>
            <span class="n">in_data</span><span class="o">=</span><span class="n">in_data</span><span class="p">,</span>
            <span class="n">in_field</span><span class="o">=</span><span class="n">in_field</span><span class="p">,</span>
            <span class="n">join_table</span><span class="o">=</span><span class="n">join_table</span><span class="p">,</span>
            <span class="n">join_field</span><span class="o">=</span><span class="n">join_field</span><span class="p">,</span>
            <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
            <span class="n">index_join_fields</span><span class="o">=</span><span class="n">index_join_fields</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_by_field, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">205</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getMessages</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># Unpack first element of result object as return value.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field,"</span><span class="p">,</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span>
          <span class="s2">"records after join."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...join_field, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">dissolve</span><span class="p">(</span><span class="n">in_features</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_feature_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
             <span class="n">dissolve_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Dissolve the polygons in a feature class based on a shared value in</span>
<span class="sd">    :a field.</span>

<span class="sd">    :param str in_features:       The path to the input feature class.</span>
<span class="sd">    :param str out_feature_class: The path to the output feature class.</span>
<span class="sd">    :param str dissolve_field:    The field to dissolve on.</span>
<span class="sd">    :return str:                  The path to the output feature class.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...dissolve, in_features"</span><span class="p">,</span> <span class="n">in_features</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...dissolve, out_feature_class:"</span><span class="p">,</span> <span class="n">out_feature_class</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...dissolve, dissolve_field:"</span><span class="p">,</span> <span class="n">dissolve_field</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">in_features</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input in_features: </span><span class="si">{</span><span class="n">in_features</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Result</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">PairwiseDissolve</span><span class="p">(</span>
            <span class="n">in_features</span><span class="o">=</span><span class="n">in_features</span><span class="p">,</span>
            <span class="n">out_feature_class</span><span class="o">=</span><span class="n">out_feature_class</span><span class="p">,</span>
            <span class="n">dissolve_field</span><span class="o">=</span><span class="p">[</span><span class="n">dissolve_field</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...dissolve, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">206</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getMessages</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># Unpack first element of result object as return value.</span>
    <span class="c1">#</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...dissolve,"</span><span class="p">,</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span>
          <span class="s2">"records after dissolve."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...dissolve, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">explode_xref</span><span class="p">(</span><span class="n">xref_table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">xref_explode_table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Explode any regular precincts for each voting precinct in</span>
<span class="sd">    the cross-reference table into multiple separate rows in a new</span>
<span class="sd">    table. Note that the key and value in the exploded results table is </span>
<span class="sd">    swapped from the input cross-reference table. The key in the output</span>
<span class="sd">    table is the regular precinct and there can be only one voting</span>
<span class="sd">    precinct for each regular precinct in the output. Each voting</span>
<span class="sd">    precinct can appear in multiple rows in the output.</span>

<span class="sd">    :param str xref_table:      The path to the cross-reference table.</span>
<span class="sd">    :param str xref_explode_table:  The path to the exploded table.</span>
<span class="sd">    :return str:                The path to the exploded table.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, xref_table"</span><span class="p">,</span> <span class="n">xref_table</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, xref_explode_table:"</span><span class="p">,</span> <span class="n">xref_explode_table</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">xref_table</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input xref_table: </span><span class="si">{</span><span class="n">xref_table</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">xref_explode_table</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input xref_explode_table: </span><span class="si">{</span><span class="n">xref_explode_table</span><span class="si">}</span><span class="s2">"</span>

    <span class="c1">#</span>
    <span class="c1"># Iterate over the cross-reference table and unpack multiple regular</span>
    <span class="c1"># precincts dictionary entries. The dictionary key is the regular </span>
    <span class="c1"># precinct and the value is the associated voting precinct.</span>
    <span class="c1">#</span>
    <span class="n">precincts_1to1</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">SearchCursor</span><span class="p">(</span>
                <span class="n">xref_table</span><span class="p">,</span> <span class="p">[</span><span class="s2">"VotePrec"</span><span class="p">,</span> <span class="s2">"_Precincts"</span><span class="p">])</span> <span class="k">as</span> <span class="n">search_cur</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">voting_precinct</span><span class="p">,</span> <span class="n">regular_precincts_str</span> <span class="ow">in</span> <span class="n">search_cur</span><span class="p">:</span>
                <span class="c1">#</span>
                <span class="c1"># Unpack the regular precincts into individual items and</span>
                <span class="c1"># add voting precinct to a dictionary with regular</span>
                <span class="c1"># precinct as the key. Note: using a set here just in</span>
                <span class="c1"># case there are any duplicate regular precincts in the</span>
                <span class="c1"># same cross-reference row.</span>
                <span class="c1">#</span>
                <span class="n">regular_precincts_set</span> <span class="o">=</span> \
                    <span class="nb">set</span><span class="p">(</span><span class="n">regular_precincts_str</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">regular_precinct</span> <span class="ow">in</span> <span class="n">regular_precincts_set</span><span class="p">:</span>
                    <span class="n">precincts_1to1</span><span class="p">[</span><span class="n">regular_precinct</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">voting_precinct</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, error in SearchCursor"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">107</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">207</span><span class="p">)</span>
    <span class="c1"># </span>
    <span class="c1"># Insert the contents of the dictionary into a table so that we can</span>
    <span class="c1"># use geo-processing tools to join to this table.</span>
    <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="p">(</span>
            <span class="n">arcpy</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">InsertCursor</span><span class="p">(</span>
                <span class="n">xref_explode_table</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"Precinct"</span><span class="p">,</span> <span class="s2">"VotePrec"</span><span class="p">])</span> <span class="k">as</span> <span class="n">insert_cur</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">regular_precinct</span><span class="p">,</span> <span class="n">voting_precinct</span> \
                    <span class="ow">in</span> <span class="n">precincts_1to1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">insert_cur</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">regular_precinct</span><span class="p">,</span>
                     <span class="n">precincts_1to1</span><span class="p">[</span><span class="n">voting_precinct</span><span class="p">]</span>
                     <span class="p">]</span>
                <span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, error in InsertCursor"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">108</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">208</span><span class="p">)</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">xref_explode_table</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...explode_xref,"</span><span class="p">,</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span>
          <span class="s2">"regular precincts have a voting precinct assigned."</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">update_precincts</span><span class="p">(</span><span class="n">precincts_fc</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Update the precincts feature class so that regular precincts that</span>
<span class="sd">    don't appear in the cross-reference table have their voting precinct</span>
<span class="sd">    set to the same value as their regular precinct. This is necessary</span>
<span class="sd">    to avoid all these precincts being dissolved into a single polygon</span>
<span class="sd">    because the share the same null value for voting precinct.</span>

<span class="sd">    :param str precincts_fc: The path to the precincts feature class.</span>
<span class="sd">    :return str:             The path to the precincts feature class.</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"...update_precincts, precincts_fc"</span><span class="p">,</span> <span class="n">precincts_fc</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">precincts_fc</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">"Can't find input precincts_fc: </span><span class="si">{</span><span class="n">precincts_fc</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">UpdateCursor</span><span class="p">(</span>
                <span class="n">precincts_fc</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Precinct"</span><span class="p">,</span> <span class="s2">"VotePrec"</span><span class="p">],</span>
                <span class="n">where_clause</span><span class="o">=</span><span class="s1">'"VotePrec" is null'</span><span class="p">)</span> <span class="k">as</span> <span class="n">update_cur</span><span class="p">:</span>
            <span class="n">update_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">update_cur</span><span class="p">:</span>
                <span class="n">precinct</span><span class="p">,</span> <span class="n">voting_precinct</span> <span class="o">=</span> <span class="n">row</span>
                <span class="k">if</span> <span class="n">voting_precinct</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">precinct</span>
                    <span class="n">update_cur</span><span class="o">.</span><span class="n">updateRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">update_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"...update_precincts,"</span><span class="p">,</span> <span class="n">update_count</span><span class="p">,</span> <span class="s2">"rows updated."</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ExecuteError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle geo-processing specific errors.</span>
        <span class="c1">#</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...update_precincts, arcpy error executing "</span>
              <span class="s2">"geo-processing tool."</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"...update_precincts, error in UpdateCursor"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">109</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Handle any other type of error.</span>
        <span class="c1">#</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">209</span><span class="p">)</span>

    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">precincts_fc</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"...update_precincts, ret_val:"</span><span class="p">,</span> <span class="n">ret_val</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">"...update_precincts,"</span><span class="p">,</span>
        <span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span>
        <span class="s2">"regular precincts with a voting precinct assigned after update."</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ret_val</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Can't find feature class: </span><span class="si">{</span><span class="n">ret_val</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">ret_val</span>


<span class="k">def</span> <span class="nf">run_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Run the geo-processing tools to buffer and join the various feature</span>
<span class="sd">    classes.</span>

<span class="sd">    :return NoneType: None</span>
<span class="sd">    """</span>
    <span class="c1">#</span>
    <span class="c1"># Load precincts from shapefile.</span>
    <span class="c1">#</span>
    <span class="n">precincts_shp_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span>
            <span class="n">g_proj_dir</span><span class="p">,</span>
            <span class="s2">"Precincts"</span><span class="p">,</span>
            <span class="s2">"Precincts.shp"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">precincts</span> <span class="o">=</span> <span class="n">load_shapefile</span><span class="p">(</span><span class="n">precincts_shp_file</span><span class="p">,</span> <span class="n">g_temp_gdb</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Load cross-reference table from dbf file.</span>
    <span class="c1">#</span>
    <span class="n">xref_dbf_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span>
            <span class="n">g_proj_dir</span><span class="p">,</span>
            <span class="s2">"Precincts"</span><span class="p">,</span>
            <span class="s2">"Precinct_Cross_Reference.dbf"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">xref</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="n">xref_dbf_file</span><span class="p">,</span> <span class="n">g_temp_gdb</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Create a table to hold exploded cross-references.</span>
    <span class="c1">#</span>
    <span class="n">xref_explode</span> <span class="o">=</span> <span class="n">create_table</span><span class="p">(</span><span class="n">g_temp_gdb</span><span class="p">,</span> <span class="s2">"xref_explode"</span><span class="p">)</span>
    <span class="n">fields_to_add</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"Precinct"</span><span class="p">,</span> <span class="s2">"TEXT"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"255"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"VotePrec"</span><span class="p">,</span> <span class="s2">"TEXT"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"255"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">xref_explode</span> <span class="o">=</span> <span class="n">add_fields</span><span class="p">(</span><span class="n">xref_explode</span><span class="p">,</span> <span class="n">fields_to_add</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Explode the cross-references.</span>
    <span class="c1">#</span>
    <span class="n">xref_explode</span> <span class="o">=</span> <span class="n">explode_xref</span><span class="p">(</span><span class="n">xref</span><span class="p">,</span> <span class="n">xref_explode</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Join the exploded cross-references to the precincts.</span>
    <span class="c1">#</span>
    <span class="n">precincts</span> <span class="o">=</span> <span class="n">join_by_field</span><span class="p">(</span>
        <span class="n">precincts</span><span class="p">,</span> <span class="s2">"Precinct"</span><span class="p">,</span> <span class="n">xref_explode</span><span class="p">,</span> <span class="s2">"Precinct"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"VotePrec"</span><span class="p">])</span>
    <span class="c1">#</span>
    <span class="c1"># Update precincts with no voting precinct.</span>
    <span class="c1">#</span>
    <span class="n">update_precincts</span><span class="p">(</span><span class="n">precincts</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Dissolve the precincts to get the voting precincts.</span>
    <span class="c1">#</span>
    <span class="n">voting_precincts</span> <span class="o">=</span> <span class="n">full_path</span><span class="p">(</span><span class="n">g_out_gdb</span><span class="p">,</span> <span class="s2">"voting_precincts"</span><span class="p">)</span>
    <span class="n">voting_precincts</span> <span class="o">=</span> <span class="n">dissolve</span><span class="p">(</span>
        <span class="n">precincts</span><span class="p">,</span> <span class="n">voting_precincts</span><span class="p">,</span> <span class="s2">"VotePrec"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">management</span><span class="o">.</span><span class="n">GetCount</span><span class="p">(</span><span class="n">voting_precincts</span><span class="p">),</span>
          <span class="s2">"voting precincts created."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">voting_precincts</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1">#</span>
    <span class="c1"># Define locations of geodatabases.</span>
    <span class="c1">#</span>
    <span class="n">my_proj_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"C:\ArcGIS_local_projects\CodeChallenge3"</span>
    <span class="n">my_in_gdb</span> <span class="o">=</span> <span class="s2">"CodeChallenge3.gdb"</span>
    <span class="c1">#</span>
    <span class="c1"># Intermediate results are written to the temporary geo-database.</span>
    <span class="c1"># To speed processing and avoid writing intermediate results to</span>
    <span class="c1"># disk this is set to "memory".</span>
    <span class="c1"># If you need to keep these results, change this to the full path of</span>
    <span class="c1"># a file geodatabase as follows:</span>
    <span class="c1"># my_temp_gdb = full_path(my_proj_dir, "CodeChallenge3.gdb")</span>
    <span class="c1">#</span>
    <span class="n">my_temp_gdb</span> <span class="o">=</span> <span class="s2">"memory"</span>
    <span class="n">my_out_gdb</span> <span class="o">=</span> <span class="s2">"CodeChallenge3.gdb"</span>
    <span class="n">setup_env</span><span class="p">(</span><span class="n">my_proj_dir</span><span class="p">,</span> <span class="n">my_in_gdb</span><span class="p">,</span> <span class="n">my_temp_gdb</span><span class="p">,</span> <span class="n">my_out_gdb</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Run the main process.</span>
    <span class="c1">#</span>
    <span class="n">run_tools</span><span class="p">()</span>

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># Sample Output</span>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># "C:\Program Files\ArcGIS\Pro\bin\Python\envs\arcgispro-py3\python.exe" C:\PythonPro\Ex11\challenge3_v1.py</span>
<span class="c1"># ...project directory: C:\ArcGIS_local_projects\CodeChallenge3</span>
<span class="c1"># ...input geo-database: C:\ArcGIS_local_projects\CodeChallenge3\CodeChallenge3.gdb</span>
<span class="c1"># ...temporary geo-database: memory</span>
<span class="c1"># ...output geo_database: C:\ArcGIS_local_projects\CodeChallenge3\CodeChallenge3.gdb</span>
<span class="c1"># ...load_shapefile, shape_file C:\ArcGIS_local_projects\CodeChallenge3\Precincts\Precincts.shp</span>
<span class="c1"># ...load_shapefile, out_gdb: memory</span>
<span class="c1"># C:\ArcGIS_local_projects\CodeChallenge3\Precincts\Precincts.shp Successfully converted:  memory\Precincts</span>
<span class="c1"># Start Time: Wednesday, May 15, 2024 4:15:29 PM</span>
<span class="c1"># C:\ArcGIS_local_projects\CodeChallenge3\Precincts\Precincts.shp Successfully converted:  memory\Precincts</span>
<span class="c1"># Succeeded at Wednesday, May 15, 2024 4:15:31 PM (Elapsed Time: 1.22 seconds)</span>
<span class="c1"># ...load_shapefile, 720 precincts loaded from shapefile.</span>
<span class="c1"># ...load_shapefile, ret_val: memory\Precincts</span>
<span class="c1"># ...load_table, dbf_file C:\ArcGIS_local_projects\CodeChallenge3\Precincts\Precinct_Cross_Reference.dbf</span>
<span class="c1"># ...load_table, out_gdb: memory</span>
<span class="c1"># Converted C:\ArcGIS_local_projects\CodeChallenge3\Precincts\Precinct_Cross_Reference.dbf to memory\Precinct_Cross_Reference successfully.</span>
<span class="c1"># Start Time: Wednesday, May 15, 2024 4:15:31 PM</span>
<span class="c1"># Converted C:\ArcGIS_local_projects\CodeChallenge3\Precincts\Precinct_Cross_Reference.dbf to memory\Precinct_Cross_Reference successfully.</span>
<span class="c1"># Succeeded at Wednesday, May 15, 2024 4:15:31 PM (Elapsed Time: 0.62 seconds)</span>
<span class="c1"># ...load_table, 138 cross_reference records loaded from dbf file.</span>
<span class="c1"># ...load_table, ret_val: memory\Precinct_Cross_Reference</span>
<span class="c1"># ...create_table, out_path memory</span>
<span class="c1"># ...create_table, out_name: xref_explode</span>
<span class="c1"># Start Time: Wednesday, May 15, 2024 4:15:31 PM</span>
<span class="c1"># Succeeded at Wednesday, May 15, 2024 4:15:31 PM (Elapsed Time: 0.01 seconds)</span>
<span class="c1"># ...create_table, ret_val: memory\xref_explode</span>
<span class="c1"># ...add_fields, in_table memory\xref_explode</span>
<span class="c1"># ...add_fields, field_description: [['Precinct', 'TEXT', '', '255', '', ''], ['VotePrec', 'TEXT', '', '255', '', '']]</span>
<span class="c1"># Start Time: Wednesday, May 15, 2024 4:15:31 PM</span>
<span class="c1"># Adding Precinct to xref_explode...</span>
<span class="c1"># Adding VotePrec to xref_explode...</span>
<span class="c1"># Succeeded at Wednesday, May 15, 2024 4:15:31 PM (Elapsed Time: 0.01 seconds)</span>
<span class="c1"># ...add_fields, ret_val: memory\xref_explode</span>
<span class="c1"># ...explode_xref, xref_table memory\Precinct_Cross_Reference</span>
<span class="c1"># ...explode_xref, xref_explode_table: memory\xref_explode</span>
<span class="c1"># ...explode_xref, ret_val: memory\xref_explode</span>
<span class="c1"># ...explode_xref, 561 regular precincts have a voting precinct assigned.</span>
<span class="c1"># ...join_field, in_data memory\Precincts</span>
<span class="c1"># ...join_field, in_field: Precinct</span>
<span class="c1"># ...join_field, join_table: memory\xref_explode</span>
<span class="c1"># ...join_field, fields: ['VotePrec']</span>
<span class="c1"># ...join_field, index_join_fields: NEW_INDEXES</span>
<span class="c1"># Start Time: Wednesday, May 15, 2024 4:15:31 PM</span>
<span class="c1"># Succeeded at Wednesday, May 15, 2024 4:15:32 PM (Elapsed Time: 0.10 seconds)</span>
<span class="c1"># ...join_field, 720 records after join.</span>
<span class="c1"># ...join_field, ret_val: memory\Precincts</span>
<span class="c1"># ...update_precincts, precincts_fc memory\Precincts</span>
<span class="c1"># ...update_precincts, 159 rows updated.</span>
<span class="c1"># ...update_precincts, ret_val: memory\Precincts</span>
<span class="c1"># ...update_precincts, 720 regular precincts with a voting precinct assigned after update.</span>
<span class="c1"># ...dissolve, in_features memory\Precincts</span>
<span class="c1"># ...dissolve, out_feature_class: C:\ArcGIS_local_projects\CodeChallenge3\CodeChallenge3.gdb\voting_precincts</span>
<span class="c1"># ...dissolve, dissolve_field: VotePrec</span>
<span class="c1"># Start Time: Wednesday, May 15, 2024 4:15:32 PM</span>
<span class="c1"># Sorting Attributes...</span>
<span class="c1"># Dissolving...</span>
<span class="c1"># Succeeded at Wednesday, May 15, 2024 4:15:33 PM (Elapsed Time: 0.91 seconds)</span>
<span class="c1"># ...dissolve, 297 records after dissolve.</span>
<span class="c1"># ...dissolve, ret_val: C:\ArcGIS_local_projects\CodeChallenge3\CodeChallenge3.gdb\voting_precincts</span>
<span class="c1"># 297 voting precincts created.</span>
<span class="c1"># C:\ArcGIS_local_projects\CodeChallenge3\CodeChallenge3.gdb\voting_precincts</span>
<span class="c1">#</span>
<span class="c1"># Process finished with exit code 0</span>
<span class="c1"># ----------------------------------------------------------------------</span>
</code></pre></div>
<p><a href="./images/santa_cruz_precincts/py/santa_cruz_precincts.py">Download .py file</a></p></main>


             
 
            
            
            







            <hr/>
        </div>
        <section class="span2" id="article-sidebar">
            <h4>Published</h4>
            <time datetime="2024-05-31T00:00:00-07:00" itemprop="dateCreated">Fri 31 May 2024</time>
<h4>Last Updated</h4>
<time datetime="2025-06-07T00:00:00-07:00">Sat 07 June 2025</time>

            <h4>Category</h4>
            <a class="category-link" href="./categories.html#arcpy-ref">ArcPy</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#arcgis-ref">ArcGIS
                    <span class="superscript">9</span>
</a></li>
                <li><a href="./tags.html#arcpy-ref">ArcPy
                    <span class="superscript">3</span>
</a></li>
                <li><a href="./tags.html#cartography-ref">Cartography
                    <span class="superscript">16</span>
</a></li>
                <li><a href="./tags.html#python-ref">Python
                    <span class="superscript">4</span>
</a></li>
            </ul>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" rel="nofollow noopener noreferrer" target="_blank" title="Pelican Home Page">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" rel="nofollow noopener noreferrer" target="_blank" title="Theme Elegant Home Page">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>
        <script src="./theme/js/jquery.colorbox.js"></script>
        <script src="./theme/js/load-colorbox.js"></script>
        <script src="https://files.stork-search.net/releases/v1.5.0/stork.js"></script>
        <script src="https://cdn.datatables.net/2.3.2/js/dataTables.js"></script>
        <script>
            stork.register("sitesearch", "./search-index.st");
        </script>
        <script>
            $(document).ready( function () {
                $('.my-data-table').DataTable();
            } );
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>